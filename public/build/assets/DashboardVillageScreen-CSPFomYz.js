import{W as me,r as l,j as s,y as O}from"./app-jVsnfUfC.js";import{X as ge}from"./index.es-D645GaJx.js";import{r as a}from"./index-jwOwvoQl.js";import{S as h}from"./react-select.esm-DbBxetWc.js";import xe from"./Layout-CTkYmVXB.js";import"./Sidebar-T6X3Soxn.js";import"./Header-D3_oKA8q.js";import"./UserMenu-D6DjFmAo.js";function pe({villages:o,districts:V}){const{data:u,setData:c,post:A,reset:H}=me(),[g,I]=l.useState(""),[be,x]=l.useState(1),[R,p]=l.useState([]),[$,b]=l.useState([]),[M,y]=l.useState([]),[v,j]=l.useState(!1),[S,f]=l.useState(!1),[C,w]=l.useState(!1),[D,W]=l.useState(null),d=e=>W(e),[N,T]=l.useState(null),m=e=>T(e),[X,k]=l.useState(""),[_,U]=l.useState(""),[Z,q]=l.useState(""),[G,J]=l.useState(""),[K,Q]=l.useState(""),Y=V.map(e=>({value:e.id,label:e.district})),ee=R.map(e=>({value:e.id,label:e.county})),se=$.map(e=>({value:e.id,label:e.subcounty})),te=M.map(e=>({value:e.id,label:e.parish})),ae=e=>{O.get("/dashboard/village",{search:g,page:e},{preserveState:!0})},le=async e=>{j(!0);try{const t=await axios.get(`/getcounties?district=${e}`);p(t.data)}catch(t){console.error("Error fetching counties:",t),p([])}finally{j(!1)}},ie=async e=>{f(!0);try{const t=await axios.get(`/getsubcounties?county=${e}`);b(t.data)}catch(t){console.error("Error fetching subcounties:",t),b([])}finally{f(!1)}},re=async e=>{w(!0);try{const t=await axios.get(`/getparishes?subcounty=${e}`);y(t.data)}catch(t){console.error("Error fetching parishes:",t),y([])}finally{w(!1)}},ne=e=>{x(e),ae(e)},ce=e=>{e.preventDefault();const t=e.target.value;I(t),x(1),O.get("/dashboard/village",{search:t,page:1},{preserveState:!0,preserveScroll:!0})},oe=e=>{e.preventDefault(),A("/dashboard/village/post",{preserveScroll:!0,preserveState:!0,onSuccess:()=>{H(),c({}),d(null)}})},ue=(e,t,i,r,n)=>{k(e),U(t),q(i),J(r),Q(n),m("xl")},de=[{name:"Village",selector:e=>e.village},{name:"Parish",selector:e=>{var t;return((t=e.parish)==null?void 0:t.parish)||""}},{name:"Subcounty",selector:e=>{var t,i;return((i=(t=e.parish)==null?void 0:t.subcounty)==null?void 0:i.subcounty)||""}},{name:"County",selector:e=>{var t,i,r;return((r=(i=(t=e.parish)==null?void 0:t.subcounty)==null?void 0:i.county)==null?void 0:r.county)||""}},{name:"District",selector:e=>{var t,i,r,n;return((n=(r=(i=(t=e.parish)==null?void 0:t.subcounty)==null?void 0:i.county)==null?void 0:r.district)==null?void 0:n.district)||""}},{name:"Added On",selector:e=>new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},{cell:e=>s.jsx("button",{onClick:()=>{var t,i,r,n,F,L,P,E,z,B;return ue(e.village,((t=e.parish)==null?void 0:t.parish)||"",((r=(i=e.parish)==null?void 0:i.subcounty)==null?void 0:r.subcounty)||"",((L=(F=(n=e.parish)==null?void 0:n.subcounty)==null?void 0:F.county)==null?void 0:L.county)||"",((B=(z=(E=(P=e.parish)==null?void 0:P.subcounty)==null?void 0:E.county)==null?void 0:z.district)==null?void 0:B.district)||"")},className:"bg-green-600 rounded-md p-1",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"white",className:"w-5 h-5",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})})})}],he={headRow:{style:{border:"none"}},headCells:{style:{color:"#997400",fontSize:"14px"}},rows:{highlightOnHoverStyle:{backgroundColor:"rgb(230, 244, 244)",borderBottomColor:"#FFFFFF",outline:"1px solid #FFFFFF"}},pagination:{style:{border:"none"}}};return s.jsxs("div",{children:[s.jsx(ge,{title:s.jsxs("div",{className:"flex flex-col md:flex-row space-x-0 md:space-x-5 space-y-5 md:space-y-0 whitespace-nowrap items-start md:items-center justify-between w-full border-b-2 border-primary pb-3 pt-2",children:[s.jsx("span",{children:"Villages"}),s.jsxs("div",{className:"flex space-x-3 items-center md:space-x-5 w-full md:w-1/2 md:justify-end print:hidden",children:[s.jsx(a.Input,{type:"text",label:"Search",value:g,onChange:ce,className:"md:w-full"}),s.jsxs(a.Button,{size:"sm",color:"success",onClick:()=>d("xl"),className:"flex h-10 items-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"mr-2 w-5 h-5",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add"]})]})]}),columns:de,data:o.data,customStyles:he,pointerOnHover:!0,highlightOnHover:!0,pagination:!0,paginationServer:!0,paginationTotalRows:o.total,paginationPerPage:o.per_page,onChangePage:ne,paginationRowsPerPageOptions:[]}),s.jsx(l.Fragment,{children:s.jsxs(a.Dialog,{open:D==="xl",size:D,handler:d,children:[s.jsx(a.DialogHeader,{children:"Add a Village"}),s.jsxs("form",{onSubmit:oe,children:[s.jsx(a.DialogBody,{divider:!0,className:"grid place-items-center gap-4",children:s.jsxs("div",{className:"space-y-4 w-full",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"District"}),s.jsx(h,{options:Y,onChange:e=>{c("district",(e==null?void 0:e.value)||""),e&&le(e.value)},placeholder:"Select district...",className:"text-sm"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"County"}),s.jsx(h,{options:ee,onChange:e=>{c("county",(e==null?void 0:e.value)||""),e&&ie(e.value)},isDisabled:!u.district||v,placeholder:v?"Loading...":"Select county...",className:"text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcounty"}),s.jsx(h,{options:se,onChange:e=>{c("subcounty",(e==null?void 0:e.value)||""),e&&re(e.value)},isDisabled:!u.county||S,placeholder:S?"Loading...":"Select subcounty...",className:"text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Parish"}),s.jsx(h,{options:te,onChange:e=>c("parish",(e==null?void 0:e.value)||""),isDisabled:!u.subcounty||C,placeholder:C?"Loading...":"Select parish...",className:"text-sm"})]}),s.jsx(a.Input,{label:"Village",value:u.village??"",onChange:e=>c("village",e.target.value),size:"sm"})]})}),s.jsxs(a.DialogFooter,{className:"space-x-2",children:[s.jsx(a.Button,{onClick:()=>d(null),variant:"gradient",color:"blue-gray",children:"Close"}),s.jsx(a.Button,{type:"submit",children:"Add"})]})]})]})}),s.jsx(l.Fragment,{children:s.jsxs(a.Dialog,{open:N==="xl",size:N,handler:m,children:[s.jsx(a.DialogHeader,{children:"Edit Village"}),s.jsxs("form",{children:[s.jsxs(a.DialogBody,{divider:!0,className:"grid place-items-center gap-4",children:[s.jsx(a.Input,{label:"District",disabled:!0,value:K,size:"sm"}),s.jsx(a.Input,{label:"County",disabled:!0,value:G,size:"sm"}),s.jsx(a.Input,{label:"Subcounty",disabled:!0,value:Z,size:"sm"}),s.jsx(a.Input,{label:"Parish",disabled:!0,value:_,size:"sm"}),s.jsx(a.Input,{label:"Village",value:X,onChange:e=>k(e.target.value),size:"sm"})]}),s.jsx(a.DialogFooter,{children:s.jsxs("div",{className:"flex w-full justify-between",children:[s.jsx(a.Button,{variant:"gradient",color:"red",children:"Delete"}),s.jsxs("div",{className:"space-x-2",children:[s.jsx(a.Button,{onClick:()=>m(null),variant:"gradient",color:"blue-gray",children:"Close"}),s.jsx(a.Button,{type:"submit",className:"bg-black",children:"Save"})]})]})})]})]})})]})}pe.layout=o=>s.jsx(xe,{children:o});export{pe as default};
