import{W as M,r as i,j as s,Y as F,y as K}from"./app-DCtpSBlG.js";import"./index.es-DWsnJMRn.js";import{r as c}from"./index-9hzoMT54.js";import{S as r}from"./react-select.esm-CPjOLduL.js";import B from"./Navbar-Q8IRkSBR.js";import{F as W}from"./Footer-kVpIoBxA.js";function X({districts:D,the_user:n}){console.log(n);const{data:t,setData:l,processing:Y,post:k,reset:I,errors:q}=M(),[P,o]=i.useState([]),[u,d]=i.useState(!1),[m,g]=i.useState(!1),[h,x]=i.useState(!1),[b,v]=i.useState(!1);i.useState(null);const[L,y]=i.useState([]),[E,f]=i.useState([]),[O,j]=i.useState([]),N=D.map(e=>({value:e.id,label:e.district})),p=P.map(e=>({value:e.id,label:e.county})),S=L.map(e=>({value:e.id,label:e.subcounty})),C=E.map(e=>({value:e.id,label:e.parish})),w=O.map(e=>({value:e.id,label:e.village})),R=async e=>{d(!0);try{const a=await axios.get(`/getcounties?district=${e}`);console.log("API Data:",a.data),o(a.data)}catch(a){console.error("Error:",a),o([])}finally{d(!1)}},V=async e=>{g(!0);try{const a=await axios.get(`/getsubcounties?subcounty=${e}`);console.log("API Data:",a.data),y(a.data)}catch(a){console.error("Error:",a),y([])}finally{g(!1)}},$=async e=>{x(!0);try{const a=await axios.get(`/getparishes?parish=${e}`);console.log("API Data:",a.data),f(a.data)}catch(a){console.error("Error:",a),f([])}finally{x(!1)}},z=async e=>{v(!0);try{const a=await axios.get(`/getvillages?village=${e}`);console.log("API Data:",a.data),j(a.data)}catch(a){console.error("Error:",a),j([])}finally{v(!1)}},A=async e=>{e.preventDefault(),k("/join/post",{user:n},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{K.visit("/registation-success"),I(),l({})}})};return s.jsxs("div",{children:[s.jsx(F,{children:s.jsx("title",{children:"Register Member"})}),s.jsx(B,{}),s.jsxs("section",{className:"max-w-4xl p-6 mx-auto bg-gray-50 rounded-md shadow-md shadow-gray-500 my-10",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Register New Kikumi Kikumi Community Member"})}),s.jsx("div",{className:"my-6",children:s.jsxs("form",{onSubmit:A,children:[s.jsx("div",{className:"w-full my-3",children:s.jsx(c.Input,{color:"deep-orange",label:"Full Name",size:"md",value:t.name??"",onChange:e=>l("name",e.target.value)})}),s.jsx("div",{className:"w-full my-3",children:s.jsx(c.Input,{color:"deep-orange",label:"National Identification Number (NIN)",size:"md",value:t.nin??"",onChange:e=>l("nin",e.target.value)})}),s.jsx("div",{className:"w-full my-3",children:s.jsx(c.Input,{color:"deep-orange",label:"Contact",size:"md",value:t.phone??"",onChange:e=>l("phone",e.target.value)})}),s.jsxs("div",{className:"my-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"District"}),s.jsx(r,{options:N,value:N.find(e=>e.value===t.district),onChange:e=>{l("district",(e==null?void 0:e.value)||""),e&&R(e.value)},placeholder:"Select district...",className:"text-sm"})]}),s.jsxs("div",{className:"my-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"County"}),s.jsx(r,{options:p,value:p.find(e=>e.value===t.county),onChange:e=>{l("county",(e==null?void 0:e.value)||""),e&&V(e.value)},isDisabled:!t.district||u,placeholder:u?"Loading...":"Select county...",className:"text-sm"})]}),s.jsxs("div",{className:"my-3",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcounty"}),s.jsx(r,{options:S,value:S.find(e=>e.value===t.subcounty),onChange:e=>{l("subcounty",(e==null?void 0:e.value)||""),e&&$(e.value)},isDisabled:!t.county||m,placeholder:m?"Loading...":"Select subcounty",className:"text-sm"})]}),s.jsxs("div",{className:"my-3",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Parish"}),s.jsx(r,{options:C,value:C.find(e=>e.value===t.parish),onChange:e=>{l("parish",(e==null?void 0:e.value)||""),e&&z(e.value)},isDisabled:!t.subcounty||h,placeholder:h?"Loading...":"Select parish",className:"text-sm"})]}),s.jsxs("div",{className:"my-3",children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Village"}),s.jsx(r,{options:w,value:w.find(e=>e.value===t.village),onChange:e=>{l("village",(e==null?void 0:e.value)||"")},isDisabled:!t.parish||b,placeholder:b?"Loading...":"Select village",className:"text-sm"})]}),s.jsx(c.Button,{className:"bg-black mt-3",type:"submit",children:"Register Member"})]})})]}),s.jsx(W,{})]})}export{X as default};
