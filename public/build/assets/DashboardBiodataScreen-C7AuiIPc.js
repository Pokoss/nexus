import{r as n,j as r,y as v,b as y}from"./app-CJboC19z.js";import M from"./Layout-DGriqsvC.js";import{X as q}from"./index.es-CVkJTfh4.js";import{r as G}from"./index-BBVTLsOf.js";import{S as p}from"./react-select.esm-CrOI7TDd.js";import"./Sidebar-YDixx-xa.js";import"./Header-CgS9YLHv.js";import"./UserMenu-QtLotUe0.js";function te({people:u,districts:f}){const[_,z]=n.useState(""),[o,g]=n.useState({district_id:"",county_id:"",subcounty_id:"",parish_id:"",village_id:""}),[S,b]=n.useState([]),[x,h]=n.useState([]),[P,d]=n.useState([]),[j,c]=n.useState([]),[C,D]=n.useState(!1),[N,w]=n.useState(!1),[L,I]=n.useState(!1),[E,T]=n.useState(!1),[J,V]=n.useState((u==null?void 0:u.current_page)||1),$=e=>{V(e),A(e)},A=(e=1)=>{v.get("/dashboard/biodata",{...o,search:_,page:e},{preserveState:!0,preserveScroll:!0})},F=e=>{e.preventDefault(),z(e.target.value),V(1),v.get("/dashboard/biodata",{...o,search:e.target.value,page:1},{preserveState:!0,preserveScroll:!0})},O=async e=>{D(!0);try{const a=await y.get(`/getcounties?district=${e}`);console.log("API Data:",a.data),b(a.data)}catch(a){console.error("Error:",a),b([])}finally{D(!1)}},R=async e=>{if(!e){h([]);return}w(!0);try{const a=await y.get(`/getsubcounties?subcounty=${e}`);h(a.data)}catch(a){console.error("Error:",a),h([])}finally{w(!1)}},B=async e=>{if(!e){d([]);return}I(!0);try{const a=await y.get(`/getparishes?parish=${e}`);console.log("API Data:",a.data),d(a.data)}catch(a){console.error("Error:",a),d([])}finally{I(!1)}},H=async e=>{if(!e){c([]);return}T(!0);try{const a=await y.get(`/getvillages?village=${e}`);console.log("API Data:",a.data),c(a.data)}catch(a){console.error("Error:",a),c([])}finally{T(!1)}},l=(e,a,s="id")=>e.map(t=>({value:t[s],label:t[a]})),m=(e,a)=>{const{name:s}=a,t=e?e.value:"";switch(s){case"district_id":g(i=>({...i,district_id:t,county_id:"",subcounty_id:"",parish_id:"",village_id:""})),t?O(t):(b([]),h([]),d([]),c([]));break;case"county_id":g(i=>({...i,county_id:t,subcounty_id:"",parish_id:"",village_id:""})),t?R(t):(h([]),d([]),c([]));break;case"subcounty_id":g(i=>({...i,subcounty_id:t,parish_id:"",village_id:""})),t?B(t):(d([]),c([]));break;case"parish_id":g(i=>({...i,parish_id:t,village_id:""})),t?H(t):c([]);break;case"village_id":g(i=>({...i,village_id:t}));break}v.get("/dashboard/biodata",{...o,[s]:t,page:1},{preserveState:!0,preserveScroll:!0})},X=[{name:"Full Name",selector:e=>e.name},{name:"NIN",selector:e=>e.nin},{name:"Phone",selector:e=>e.phone},{name:"District",selector:e=>{var a,s,t,i,k;return(k=(i=(t=(s=(a=e.village)==null?void 0:a.parish)==null?void 0:s.subcounty)==null?void 0:t.county)==null?void 0:i.district)==null?void 0:k.district}},{name:"County",selector:e=>{var a,s,t,i;return(i=(t=(s=(a=e.village)==null?void 0:a.parish)==null?void 0:s.subcounty)==null?void 0:t.county)==null?void 0:i.county}},{name:"Subcounty",selector:e=>{var a,s,t;return(t=(s=(a=e.village)==null?void 0:a.parish)==null?void 0:s.subcounty)==null?void 0:t.subcounty}},{name:"Parish",selector:e=>{var a,s;return(s=(a=e.village)==null?void 0:a.parish)==null?void 0:s.parish}},{name:"Village",selector:e=>{var a;return(a=e.village)==null?void 0:a.village}},{name:"Registered On",selector:e=>new Date(e.created_at).toLocaleDateString()}];return r.jsx(M,{children:r.jsx("div",{className:"p-2",children:r.jsx(q,{title:r.jsxs("div",{className:"p-2 flex flex-col md:flex-row justify-between items-start md:items-center w-full border-b pb-3 mb-4 gap-4",children:[r.jsx("span",{children:"Person Bio Data"}),r.jsxs("div",{className:"w-full md:w-4/3 space-y-2",children:[r.jsx(G.Input,{label:"Search Person",value:_,onChange:F}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-1",children:[r.jsx(p,{name:"district_id",value:l(f,"district").find(e=>e.value===o.district_id),onChange:m,options:l(f,"district"),placeholder:"District",isClearable:!0,isLoading:!1,className:"text-sm",styles:{menuPortal:e=>({...e,zIndex:9999})},menuPortalTarget:document.body}),r.jsx(p,{name:"county_id",value:l(S,"county").find(e=>e.value===o.county_id),onChange:m,options:l(S,"county"),placeholder:"County",isDisabled:!o.district_id||C,isLoading:C,className:"text-sm",styles:{menuPortal:e=>({...e,zIndex:9999})},menuPortalTarget:document.body}),r.jsx(p,{name:"subcounty_id",value:l(x,"subcounty").find(e=>e.value===o.subcounty_id),onChange:m,options:l(x,"subcounty"),placeholder:"Subcounty",isDisabled:!o.county_id||N,isLoading:N,className:"text-sm",styles:{menuPortal:e=>({...e,zIndex:9999})},menuPortalTarget:document.body}),r.jsx(p,{name:"parish_id",value:l(P,"parish").find(e=>e.value===o.parish_id),onChange:m,options:l(P,"parish"),placeholder:"Parish",isDisabled:!o.subcounty_id||L,isLoading:L,className:"text-sm",styles:{menuPortal:e=>({...e,zIndex:9999})},menuPortalTarget:document.body}),r.jsx(p,{name:"village_id",value:l(j,"village").find(e=>e.value===o.village_id),onChange:m,options:l(j,"village"),placeholder:"Village",isDisabled:!o.parish_id||E,isLoading:E,className:"text-sm",styles:{menuPortal:e=>({...e,zIndex:9999})},menuPortalTarget:document.body})]})]})]}),columns:X,data:u.data,pagination:!0,paginationServer:!0,paginationTotalRows:u.total,paginationPerPage:u.per_page,onChangePage:$,highlightOnHover:!0,pointerOnHover:!0})})})}export{te as default};
